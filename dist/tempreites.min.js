(function(a,b){if(typeof exports==="object"){module.exports=b()}else{if(typeof define==="function"&&define.amd){define(function(){return b()})}else{a.Tempreites=b()}}}(this,function(){var p={create:function(t,s){var r=0;var v={text:"",peek:function(w){w=w||1;return this.raw.substr(r+1,w)},read:function(x){if(x===0){return""}x=x||1;var w=this.peek(x);r+=x;if(r>this.length){r=this.length}return w},readUntilNonWhitespace:function(){var x="",w;while(!this.isEof()){w=this.read();x+=w;if(!/\s$/.test(x)){break}}return x},isEof:function(){return r>=this.length},readRegex:function(w){var x=(w.exec(this.raw.substring(this.index))||[""])[0];r+=x.length;return x},peekIgnoreWhitespace:function(x){x=x||1;var y="",w="",z=0;do{w=this.raw.charAt(this.index+ ++z);if(!w){break}if(!/\s/.test(w)){y+=w}}while(y.length<x);return y}};v.__defineGetter__("current",function(){return this.isEof()?"":this.raw.charAt(this.index)});v.__defineGetter__("raw",function(){return t});v.__defineGetter__("length",function(){return this.raw.length});v.__defineGetter__("index",function(){return r});v.__defineGetter__("substring",function(){return this.raw.substring(this.index)});v.callbacks={};var u=["openElement","closeElement","attribute","comment","cdata","text","docType","xmlProlog","closeOpenedElement"];u.forEach(function(w){v.callbacks[w]=s[w]||function(){}});return v}};var k=/[a-zA-Z_][\w:-]*/;function o(v){var u=v.readRegex(k);var w=null;if(v.current==="="||v.peekIgnoreWhitespace()==="="){v.readRegex(/\s*=\s*/);var r=/['"]/.test(v.current)?v.current:"";var t=!r?/(.*?)(?=[\s>])/:new RegExp(r+"(.*?)"+r);var s=t.exec(v.substring)||[0,""];w=s[1];v.read(s[0].length)}v.callbacks.attribute(u,w)}function j(s,u){function r(){if(u){return s.current==="?"&&s.peek()===">"}return s.current===">"||(s.current==="/"&&s.peekIgnoreWhitespace()===">")}var t=s.current;while(!s.isEof()&&!r()){if(k.test(t)){o(s);t=s.current}else{t=s.read()}}}function m(u,s){var r;var t={area:true,base:true,basefont:true,br:true,col:true,frame:true,hr:true,img:true,input:true,isindex:true,link:true,meta:true,param:true,embed:true};if(s in t){r=true}if(u.current==="/"){u.readUntilNonWhitespace();u.read();u.callbacks.closeOpenedElement(s,"/>",r)}else{if(u.current==="?"){u.read(2);u.callbacks.closeOpenedElement(s,"?>",r)}else{u.read();u.callbacks.closeOpenedElement(s,">",r)}}}function q(t){var s=t.readRegex(k);t.callbacks.openElement(s);j(t,false);m(t,s);if(!/^(script|xmp)$/i.test(s)){return}var u=new RegExp("^([\\s\\S]*?)(?:$|</("+s+")\\s*>)","i");var r=u.exec(t.substring);t.read(r[0].length);if(r[1]){t.callbacks.cdata(r[1])}if(r[2]){t.callbacks.closeElement(r[2])}}function i(s){var r=s.readRegex(k);s.callbacks.closeElement(r);s.readRegex(/.*?(?:>|$)/)}function l(s){s.read(8);var r=/^([\s\S]*?)(?:$|]]>)/.exec(s.substring);var t=r[1];s.read(r[0].length);s.callbacks.cdata(t)}function e(s){s.read(3);var r=/^([\s\S]*?)(?:$|-->)/.exec(s.substring);var t=r[1];s.read(r[0].length);s.callbacks.comment(t)}function g(s){s.read(8);var r=/^\s*([\s\S]*?)(?:$|>)/.exec(s.substring);var t=r[1];s.read(r[0].length);s.callbacks.docType(t)}function a(r){r.read(4);r.callbacks.xmlProlog();j(r,true);m(r,"?xml")}function f(s,r){r.text+=s}function h(r){if(r.text){r.callbacks.text(r.text);r.text=""}}function c(s){var t=s.current,r=t;if(t=="<"){r+=s.read();if(s.current==="/"){r+=s.read();if(k.test(s.current)){h(s);i(s)}else{s.read();f(r,s)}}else{if(s.current==="!"){if(/^!\[CDATA\[/.test(s.substring)){h(s);l(s)}else{if(/^!--/.test(s.substring)){h(s);e(s)}else{if(/^!doctype/i.test(s.substring)){h(s);g(s)}else{s.read();f(r,s)}}}}else{if(s.current==="?"){if(/^\?xml/.test(s.substring)){h(s);a(s)}else{s.read();f(r,s)}}else{if(k.test(s.current)){h(s);q(s)}else{s.read();f(r,s)}}}}}else{f(s.current,s);s.read()}}var d=function(t,s){t=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n");var r=p.create(t,s);do{c(r)}while(!r.isEof());h(r)};if(!Array.isArray){Array.isArray=function(r){return Object.prototype.toString.call(r)==="[object Array]"}}var n=function(r){if(r.replace){return r.replace(/(<|>|"|'|&)/g,"")}return r};var b=function(y,w){var t="";var r=[];if(y.sonsRef&&w[y.sonsRef]&&typeof w[y.sonsRef]==="object"){if(Array.isArray(w[y.sonsRef])){for(var v=0;v<w[y.sonsRef].length;v++){for(var u=0;u<y.sons.length;u++){var z=y.sons[u];r.push(b(z,w[y.sonsRef][v]))}}}else{var A=w[y.sonsRef];for(var u=0;u<y.sons.length;u++){var z=y.sons[u];r.push(b(z,A))}}}else{for(var u=0;u<y.sons.length;u++){var z=y.sons[u];r.push(b(z,w))}}var x=y.content;if(y.contentRef){if(typeof w[y.contentRef]==="string"||typeof w[y.contentRef]==="number"){x=w[y.contentRef]}}if(y.dataAttrRef&&y.dataAttrRef.dataKey&&y.dataAttrRef.htmlAttr){if(typeof w[y.dataAttrRef.dataKey]==="string"||typeof w[y.dataAttrRef.dataKey]==="number"){y.attrs[y.dataAttrRef.htmlAttr]=n(w[y.dataAttrRef.dataKey])}}var C=[];for(var B in y.attrs){if(y.attrs[B]){C.push(B+'="'+y.attrs[B]+'"')}else{C.push(B)}}var D=C.join(" ");if(D){D=" "+D}if(!y.dataShowRef||y.dataShowRef&&w[y.dataShowRef]){var s=y.open+D+y.close+x+r.join(" ")+y.end+"\n";t+=s}return t};return{render:function(r,s){var t=this.compile(r);return t.render(s)},compile:function(t){var r=[];var s=[];d(t,{docType:function(x){var v={};v[x]=null;var w={tag:"",open:"<!doctype",close:">",sons:[],end:" ",attrs:v,content:""};s.push(w)},openElement:function(v){var w={tag:v,open:"<"+v,attrs:{},dataAttrRef:{},dataShowRef:null,content:"",contentRef:null,end:"",sons:[]};r.push(w)},attribute:function(w,x){var v=r.slice(-1)[0];if(w==="data-bind-here"){v.dataAttrRef.htmlAttr=x}if(w==="data-bind-there"){v.dataAttrRef.dataKey=x}if(w==="data-show-if"){v.dataShowRef=x}if(w==="class"){v.contentRef=x;v.sonsRef=x}if(w==="id"){v.contentRef=x;v.sonsRef=x}v.attrs[w]=x},closeOpenedElement:function(v,z,w){var y=r.slice(-1)[0];y.close=z;if(w){y.end=" ";var x=r.slice(-2,-1)[0];if(x){x.sons.push(y)}else{s.push(y)}var A=r.pop();if(!r.length){s.push(A)}}},text:function(x){var v=r.slice(-1)[0];var w={tag:"",open:" ",close:" ",sons:[],end:" ",attrs:{},content:x};if(v){v.sons.push(w)}else{s.push(w)}},cdata:function(w){var v=r.slice(-1)[0];v.content=w},closeElement:function(v){var x=r.slice(-1)[0];if(x.tag!==v){throw new Error("Error matching end tag with previously opened element.\nopened element: "+x.tag+"\nclosing tag: "+v+"\n")}x.end="</"+v+">";var w=r.slice(-2,-1)[0];if(w){w.sons.push(x)}var y=r.pop();if(!r.length){s.push(y)}}});var u={elements:s,render:function(x){x=x||{};var w="";for(var v=0;v<this.elements.length;v++){w+=b(this.elements[v],x)}return w}};return u}}}));
